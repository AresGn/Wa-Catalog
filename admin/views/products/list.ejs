<div class="page-header">
  <h1><i class="fas fa-box"></i> Products Management</h1>
  <a href="/products/new" class="btn btn-primary"><i class="fas fa-plus"></i> Add New Product</a>
</div>

<% if (products && products.length > 0) { %>
  <div class="table-responsive">
    <table class="table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Vendor</th>
          <th>Category</th>
          <th>Price</th>
          <th>Stock</th>
          <th>Condition</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% products.forEach(product => { %>
          <tr>
            <td><%= product.name %></td>
            <td><%= product.vendors?.name || 'N/A' %></td>
            <td><%= product.category %></td>
            <td><%= product.price.toLocaleString() %> FCFA</td>
            <td>
              <span class="stock <%= product.availability === 'in_stock' ? 'stock-in' : 'stock-out' %>">
                <% if (product.availability === 'in_stock') { %>
                  <i class="fas fa-check"></i> In Stock
                <% } else { %>
                  <i class="fas fa-times"></i> Out
                <% } %>
              </span>
            </td>
            <td><%= product.condition %></td>
            <td>
              <a href="/products/<%= product.id %>/edit" class="btn btn-sm btn-secondary"><i class="fas fa-edit"></i> Edit</a>
              <button class="btn btn-sm btn-danger" onclick="deleteProduct('<%= product.id %>')"><i class="fas fa-trash"></i> Delete</button>
            </td>
          </tr>
        <% }); %>
      </tbody>
    </table>
  </div>
<% } else { %>
  <div class="empty-state">
    <p><i class="fas fa-inbox" style="font-size: 40px; color: #ddd; margin-bottom: 10px; display: block;"></i>No products found</p>
    <a href="/products/new" class="btn btn-primary"><i class="fas fa-plus"></i> Create your first product</a>
  </div>
<% } %>

<script>
function deleteProduct(id) {
  if (confirm('Are you sure you want to delete this product?')) {
    fetch(`/api/products/${id}`, { method: 'DELETE' })
      .then(r => r.ok ? location.reload() : alert('Error deleting product'))
      .catch(e => alert('Error: ' + e.message));
  }
}
</script>
